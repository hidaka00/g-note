# 拡張機能 仕様書（Vsnote改良版）

## 0. エレベーターピッチ
ワークスペースに依存せず、ユーザーが登録した**グローバルフォルダ**をサイドバーで一覧管理。ツリーから **新規作成 / 削除 / 名前変更 / オープン / 移動（将来）** を行える VS Code 拡張。Vsnote の利点を活かしつつ、実用的なファイル操作を追加。

---

## 1. 機能要件（Functional Requirements）

### 1.1 グローバルフォルダ管理
- フォルダ登録 / 解除（複数可）
- 登録済みフォルダをサイドバーにツリー表示
- フォルダ名は実ディレクトリ名を表示（エイリアス対応は将来）
- フォルダが削除/移動されている場合のハンドリング（エラー/再リンク）

### 1.2 ファイル/フォルダ操作
- **新規作成**: ファイル/フォルダ
- **削除**: ファイル/フォルダ（確認ダイアログ）
- **名前変更**: ファイル/フォルダ
- **開く**: エディタで開く（ファイル）、エクスプローラで開く（フォルダ）
- **更新**: 手動リフレッシュ（自動ウォッチは将来）
- 将来: ドラッグ&ドロップ移動 / コピー、複数選択、検索

### 1.3 表示/UX
- サイドバー View（TreeView）
- コンテキストメニュー：ノード種別（root/dir/file）でアクション分岐
- ファイルタイプに応じたアイコン（VS Code の ThemeIcon）
- 失敗時のトースト通知・詳細ログ出力

### 1.4 永続化
- VS Code **globalState** にフォルダリストを保存
  - キー: `globoNote.folders: string[]`（`vscode.Uri.toString()`）
  - バージョン: `globoNote.schemaVersion: number`

### 1.5 権限/安全性
- 削除時は確認（`vscode.window.showWarningMessage`）
- 既存ファイルとの衝突チェック（上書き確認 or 自動リネーム）
- OS ごとの予約文字チェック（Windows の `<>:"/\|?*` など）

### 1.6 国際化
- 英日メッセージ（将来）— まずは英語/日本語混在の簡易対応

---

## 2. 非機能要件（Non-Functional Requirements）
- **パフォーマンス**: 3,000 ファイル規模でも 200ms 以内のツリー展開を目標（遅延読み込み / ページングは将来）
- **信頼性**: 例外時のユーザー影響最小化（再試行・フォールバック）
- **可観測性**: `outputChannel` へ詳細ログ、`console.error` は抑制
- **拡張性**: フォルダタグ付け、最近使用、全文検索など拡張を想定

---

## 3. 画面設計（UI）

### 3.1 サイドバー View
- View ID: `globoNote.globalFolders`
- タイトル: `Global Folders`
- ルート: 登録済みフォルダ
- 子: ディレクトリ/ファイル（1 階層ずつ遅延展開）

### 3.2 コンテキストメニュー（例）
- ルート（フォルダ）
  - `New File...`
  - `New Folder...`
  - `Refresh`
  - `Open in OS...`
  - `Remove Folder from List`
- ディレクトリ
  - `New File...`
  - `New Folder...`
  - `Rename...`
  - `Delete...`
  - `Open in OS...`
  - `Refresh`
- ファイル
  - `Open`
  - `Rename...`
  - `Delete...`
  - `Reveal in OS...`

---

